# InfraHub — environment variable template.
#
# Copy to .env and fill in any blank values before running locally:
#   cp .env.example .env
#
# When running via docker-compose, the DB_URL and LDAP_* keys are overridden
# by the service `environment:` block in docker-compose.yml, so you only need
# to set JWT_SECRET (and the ArgoCD / external-API vars if testing those flows).

# ── Database ──────────────────────────────────────────────────────────────────
# Required.  Connection string for PostgreSQL (asyncpg driver).
DB_URL=postgresql+asyncpg://infrahub:infrahub@localhost:5432/infrahub

# ── Authentication ────────────────────────────────────────────────────────────
# Required.  HS256 signing secret for JWT tokens.
# Must be at least 32 characters.  Generate with: openssl rand -hex 32
JWT_SECRET=change-me-in-production-must-be-at-least-32-chars

# ── LDAP ──────────────────────────────────────────────────────────────────────
LDAP_HOST=localhost
LDAP_PORT=389
LDAP_USE_SSL=false
LDAP_BIND_DN=cn=admin,dc=corp,dc=local
LDAP_BIND_PASSWORD=admin
# Users must live directly under this OU.
# RealLDAPClient binds as: cn=<username>,<LDAP_BASE_DN>
LDAP_BASE_DN=ou=users,dc=corp,dc=local

# ── ArgoCD ────────────────────────────────────────────────────────────────────
# Without a real ArgoCD, project provisioning will fail at the git-push/sync
# step and project rows will remain in status=provisioning.  This is expected
# in local dev.
ARGOCD_URL=http://argocd.internal
ARGOCD_TOKEN=
ARGOCD_APP_NAME=infrahub-namespaces

# ── External bare-metal inventory API ─────────────────────────────────────────
# Without a real inventory API, server sync will fail gracefully.
# Seed servers manually in postgres for UI testing.
EXTERNAL_SERVER_API_URL=http://baremetal-api.internal/servers
EXTERNAL_API_TIMEOUT_SECONDS=30
SYNC_INTERVAL_MINUTES=60

# ── Helm chart git repo ───────────────────────────────────────────────────────
# Path inside the container where src/helm is mounted.
# The entrypoint initialises this as a local git repo on first start.
HELM_GIT_REPO_PATH=/app/helm-repo

# ── Performance tier classification ───────────────────────────────────────────
# Servers with cpu >= this value are classified as high_performance; others
# are regular.
PERFORMANCE_TIER_CPU_THRESHOLD=64

# ── CPU calculator ────────────────────────────────────────────────────────────
# 1 high_performance CPU is equivalent to this many regular CPUs.
CPU_HP_TO_REGULAR_RATIO=2.0
